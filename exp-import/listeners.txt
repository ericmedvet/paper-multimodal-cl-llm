$consoleL = ea.l.console(
  functions = + [
    ea.f.quality(of = ea.f.best(); format = "%6.4f")
  ] + (of = (simulation = $validationSims)
  * [ds.f.simulate(of = ea.f.solution(of = ea.f.best()))])
  * [f.composition(then = $objFun)];
  onlyLast = false
)

$bestSaverL = ea.l.saveForRun(
  path = "./results/final-best.base64";
  overwrite = true;
  of = ea.acc.all(eFunction = ea.f.firsts(); listFunction = f.nTh(n = -1));
  processor = f.toBase64(of = f.each(of = f.subList(from = 0; to = 1; relative = false); mapF = ea.f.genotype()));
  overwrite = true
)

$bestTrajSaverL = ea.l.saveForRun(
  path = "./results/{name}/{startTime}/best-traj-{run.solver.name}-{run.randomGenerator.seed:%04d}.svg";
  of = ea.acc.lastBest();
  processor = ea.f.toImage(
    drawer = ds.d.navigation();
    of = ds.f.simulate(simulation = $lastSim; of = ea.f.solution());
    type = svg
  )
)

$qPlotL = ea.l.savePlotAndCsvForRun(
  path = "./results/{name}/{startTime}/best-quality.svg";
  plot = ea.plot.single.quality();
  type = svg
)

$valPlotL = ea.l.savePlotAndCsvForRun(
  path = "./results/{name}/{startTime}/best-on-validation.svg";
  plot = ea.plot.single.xyrsRun(ys = (of = (simulation = $validationSims)
  * [ds.f.simulate(of = ea.f.solution(of = ea.f.best()))])
  * [f.composition(then = $objFun)]
  );
  type = svg
)

$currPlotL = ea.l.savePlotAndCsvForRun(
  path = "./results/{name}/{startTime}/best-on-all-stages.svg";
  plot = ea.plot.single.xyrsRun(ys = (of = (simulation = $curriculumSims)
  * [ds.f.simulate(of = ea.f.solution(of = ea.f.best()))])
  * [f.composition(then = $objFun)]
  );
  type = svg
)

$bestValTrajSaverLs = (processor = (of = (simulation = $validationSims)
* [ds.f.simulate(of = ea.f.solution())])
* [ea.f.toImage(drawer = ds.d.navigation(); type = svg)])
* [ea.l.saveForRun(path = "./results/{name}/{startTime}/best-validation-traj-{run.solver.name}-{run.randomGenerator.seed:%04d}.svg"; of = ea.acc.lastBest())]

$bestValTrajsSaverL = ea.l.saveForRun(
  path = "./results/{name}/{startTime}/best-val-trajs-{run.solver.name}-{run.randomGenerator.seed:%04d}.svg";
  of = ea.acc.lastBest();
  processor = ea.f.toMultiImage(
    drawer = ds.d.navigation();
    of = f.all(
      of = ea.f.solution();
      fs = (simulation = $validationSims) * [ds.f.simulate()]
    );
    type = svg
  )
)

